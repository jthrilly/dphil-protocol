<div class="container">
    <div class="col-xs-8">
        <div class="form"></div>
    <div>
</div>

<script type="text/javascript">
var form = new window.netCanvas.Modules.FormBuilder();
form.build($('.form'), {
	'heading': 'About your Personal Budget',
	'fields': {
		'pbudget_amnt': {
			'type':'number',
            'prefix': '£',
            'min': '0.00',
            'max': '1000',
			'title':'Each week, how much does your personal budget give you towards your care needs?',
			'required':true,
			'placeholder': '0'
		},
        'carecost_amnt': {
			'type':'number',
            'prefix': '£',
            'min': '0.00',
            'max': '1000',
			'title':'How much do you estimate your care to cost in total each week?',
			'required':true,
			'placeholder': '0'
		},
        'pbudget_managed': {
            'type': 'checkbox',
            'inline': false,
            'title':'In what form(s) do you receive your personal budget? Please tick all that apply.',
            'variables':[
                {label:'As a direct payment', value:'1', id:'direct_payment'},
                {label:'Managed by a Local Authority', value:'1', id:'local_authority'},
                {label:'Managed by a carer', value:'1', id:'carer'},
                {label:'Managed by a third party or other organisation', value:'1', id:'other'}
            ]
        }
	},
	'options':{
		'attributes':{
			'action':'http://httpbin.org/post',
			'method':'post'
		},
		onSubmit: function(data) {
            console.log(data);
            if (window.network.egoExists()) {
                // overwrite the data for the next step

                window.network.updateNode(window.network.getEgo().id, data, function() {
                    var ego = window.network.getEgo();
                    delete ego.pbudget_proportions;
                    window.netCanvas.Modules.session.saveData();
                    window.netCanvas.Modules.session.nextStage();
                });
            } else {
                note.error('Data cannot be submitted because no ego was found!');
            }
		},
		onLoad: function() {
                if (window.network.egoExists()) {
		            var ego = window.network.getEgo();
		            form.addData(ego);
		        }
		},
		'buttons':{
			'submit':{
				label: 'Continue',
                update_label: 'Update and Continue',
				id: 'submit-btn',
				type: 'submit',
				class: 'btn-primary'
			}
		}
	}
});


</script>
